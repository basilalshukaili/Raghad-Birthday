<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Save Location to Cloud</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        button {
            padding: 10px 20px;
            font-size: 18px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        .status {
            margin-top: 20px;
            font-size: 18px;
            color: blue;
        }
    </style>
</head>
<body>

    <h1>Save Your Location</h1>
    <button onclick="saveToCloud()">Save My Location</button>
    <div class="status" id="statusMessage"></div>

    <script>
        const JSONBIN_URL = "https://api.jsonbin.io/v3/b/67ce13c8e41b4d34e4a39826";
const JSONBIN_API_KEY = "$2a$10$5BhcLjw.9GGSEI6IQhXam.WDnJ/E2E1/apvz6RIeRpJQlAkGqU0OK";

function updateStatus(message, color = 'blue') {
    const statusElement = document.getElementById('statusMessage');
    statusElement.textContent = message;
    statusElement.style.color = color;
}

function saveToCloud() {
    updateStatus("Getting your location...");

    if (!navigator.geolocation) {
        updateStatus("Geolocation not supported", "red");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        async (position) => {
            const lat = position.coords.latitude.toFixed(6);
            const lon = position.coords.longitude.toFixed(6);
            const timestamp = new Date().toISOString();

            try {
                // Fetch existing data
                const response = await fetch(JSONBIN_URL, {
                    headers: { "X-Master-Key": $2a$10$5BhcLjw.9GGSEI6IQhXam.WDnJ/E2E1/apvz6RIeRpJQlAkGqU0OK }
                });
                const data = await response.json();
                const locations = data.record.locations || [];

                // Append new location
                locations.push({ latitude: lat, longitude: lon, timestamp });

                // Update JSONBin
                await fetch(JSONBIN_URL, {
                    method: "PUT",
                    headers: {
                        "Content-Type": "application/json",
                        "X-Master-Key": $2a$10$5BhcLjw.9GGSEI6IQhXam.WDnJ/E2E1/apvz6RIeRpJQlAkGqU0OK
                    },
                    body: JSON.stringify({ locations })
                });

                updateStatus("Location saved successfully!", "green");
            } catch (error) {
                updateStatus("Error saving location", "red");
                console.error(error);
            }
        },
        () => updateStatus("Location access denied", "red"),
        { enableHighAccuracy: true, timeout: 5000 }
    );
}

    </script>
</body>
</html>
